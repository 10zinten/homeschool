{% extends "app_base.html" %}

{% block head_title %}{{ course.name }} for {{ student.first_name }}{% endblock %}

{% block main %}
  <h1 class="flex-grow font-thin text-2xl text-blue-900 mb-8">
    <a class="hover:underline" href="{% url "courses:detail" course.uuid %}">{{ course.name }}</a>
    <svg class="h-6 w-6 pb-1 inline fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M12.95 10.707l.707-.707L8 4.343 6.586 5.757 10.828 10l-4.242 4.243L8 15.657l4.95-4.95z"/></svg>
    {{ student.first_name }}
  </h1>

  {% if not course.is_running %}
    <ul class="flex flex-row mx-4 -mt-4 mb-4">
      <li class="bg-blue-100 border border-blue-200 text-blue-900 p-4 mx-2 rounded-lg shadow-sm">The course is not running so forecasting of planned completion is not possible.</li>
    </ul>
  {% endif %}

  <div class="flex flex-col sm:flex-row max-w-2xl text-sm uppercase tracking-wide font-thin">
    <div class="p-2 w-8/12">Task</div>
    <div class="p-2 w-4/12">Planned Completion</div>
  </div>

  {% for task_item in task_items %}
    <div id="task-{{ task_item.course_task.uuid }}" class="flex flex-col sm:flex-row border-t border-yellow-400 max-w-2xl">
      {% if task_item.coursework %}
        <div class="w-8/12 p-2 text-sm font-light overflow-x-scroll">
          <a href="{% url "courses:task_edit" uuid=task_item.course_task.uuid %}?next={{ request.get_full_path|urlencode }}%23task-{{ task_item.course_task.uuid }}" class="text-gray-400 hover:text-gray-600">
            {{ task_item.course_task.description|linebreaksbr }}
          </a>
        </div>
        <div class="w-3/12 p-2 pl-8 text-sm font-light text-gray-400">{{ task_item.coursework.completed_date|date:"Y-m-d" }}</div>
      {% else %}
        <div class="w-8/12 p-2 text-sm font-light overflow-x-scroll">
          <a href="{% url "courses:task_edit" uuid=task_item.course_task.uuid %}?next={{ request.get_full_path|urlencode }}%23task-{{ task_item.course_task.uuid }}" class="hover:text-gray-600">
            {{ task_item.course_task.description|linebreaksbr }}
          </a>
        </div>
        <div class="w-3/12 p-2 pl-8 text-sm font-light">
          {% if task_item.planned_date %}
            {{ task_item.planned_date|date:"Y-m-d" }}
          {% endif %}
        </div>
      {% endif %}
      <div class="p-2 flex items-center justify-center w-1/12">
        <a href="{% url "students:grade_task" uuid=student.uuid course_task_uuid=task_item.course_task.uuid %}?previous_task={{ task_item.course_task.uuid }}&next={{ request.path|urlencode }}%23task-{{ task_item.course_task.uuid }}" class="block mx-1 text-gray-300 hover:text-gray-600">
          {% if task_item.has_graded_work %}
            <svg class="h-4 w-4 mr-1 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
              <title>Graded Task</title>
              <path d="M7.03 2.6a3 3 0 0 1 5.94 0L15 3v1h1a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h1V3l2.03-.4zM5 6H4v12h12V6h-1v1H5V6zm5-2a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
            </svg>
          {% else %}
            <div class="h-4 w-4 mr-1"></div>
          {% endif %}
        </a>
        <a href="{% url "students:coursework" uuid=student.uuid course_task_uuid=task_item.course_task.uuid %}?previous_task={{ task_item.course_task.uuid }}&next={{ request.path|urlencode }}%23task-{{ task_item.course_task.uuid }}" class="block mx-1 text-gray-300 hover:text-gray-600">
          <svg class="h-4 w-4 mr-1 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
            <title>Set the completed date of the task</title>
            <path d="M1 4c0-1.1.9-2 2-2h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V4zm2 2v12h14V6H3zm2-6h2v2H5V0zm8 0h2v2h-2V0zM5 9h2v2H5V9zm0 4h2v2H5v-2zm4-4h2v2H9V9zm0 4h2v2H9v-2zm4-4h2v2h-2V9zm0 4h2v2h-2v-2z"/>
          </svg>
        </a>
        <a href="{% url "courses:task_create" uuid=course.uuid %}?previous_task={{ task_item.course_task.uuid }}&next={{ request.path|urlencode }}%23task-{{ task_item.course_task.uuid }}" class="block mx-1 text-gray-300 hover:text-gray-600">
          <svg class="h-4 w-4 mr-1 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
            <title>Create task after this task</title>
            <path d="M11 9V5H9v4H5v2h4v4h2v-4h4V9h-4zm-1 11a10 10 0 1 1 0-20 10 10 0 0 1 0 20z"/>
          </svg>
        </a>
      </div>
    </div>
  {% endfor %}

  <p class="text-sm text-gray-700 font-light mt-4">
  {% if request.GET.completed_tasks %}
    <a class="hover:underline" href="{% url 'students:course' student.uuid course.uuid %}">Hide completed tasks</a>
  {% else %}
    <a class="hover:underline" href="{% url 'students:course' student.uuid course.uuid %}?completed_tasks=1">Show completed tasks</a>
  {% endif %}
  </p>

{% endblock %}
